@startuml UseCaseDiagram
!theme plain
title ユースケース図 - Zoom Video Mover

' アクター定義
actor "エンドユーザー" as User
actor "Zoom API" as ZoomAPI
actor "ファイルシステム" as FileSystem
actor "設定ファイル" as ConfigFile

package "Zoom Video Mover システム" {
  
  package "認証機能" {
    usecase "OAuth認証実行" as UC001
    usecase "認証情報保存" as UC002
    usecase "トークン自動更新" as UC003
    usecase "認証状態確認" as UC004
  }
  
  package "録画検索・管理機能" {
    usecase "録画リスト取得" as UC005
    usecase "期間フィルタ設定" as UC006
    usecase "ファイル種別選択" as UC007
    usecase "録画メタデータ表示" as UC008
    usecase "AI要約取得" as UC009
  }
  
  package "ダウンロード機能" {
    usecase "ダウンロード実行" as UC010
    usecase "並列ダウンロード制御" as UC011
    usecase "進捗監視" as UC012
    usecase "エラー処理・リトライ" as UC013
    usecase "ダウンロード履歴管理" as UC014
  }
  
  package "設定管理機能" {
    usecase "OAuth設定" as UC015
    usecase "ダウンロード先設定" as UC016
    usecase "フィルタ設定保存" as UC017
    usecase "アプリケーション設定" as UC018
  }
  
  package "UI制御機能" {
    usecase "メイン画面表示" as UC019
    usecase "設定画面表示" as UC020
    usecase "進捗画面表示" as UC021
    usecase "エラー通知表示" as UC022
  }
}

' 主要ユースケース関係
User --> UC001 : "認証開始"
User --> UC005 : "録画検索"
User --> UC006 : "期間指定"
User --> UC007 : "種別選択"
User --> UC010 : "ダウンロード開始"
User --> UC015 : "OAuth設定"
User --> UC016 : "保存先設定"
User --> UC019 : "アプリ起動"

' システム間相互作用
UC001 --> ZoomAPI : "OAuth認証"
UC005 --> ZoomAPI : "録画リスト要求"
UC009 --> ZoomAPI : "AI要約要求"
UC010 --> ZoomAPI : "ファイルダウンロード"

UC002 --> ConfigFile : "認証情報保存"
UC015 --> ConfigFile : "OAuth設定保存"
UC016 --> ConfigFile : "パス設定保存"
UC017 --> ConfigFile : "フィルタ保存"

UC010 --> FileSystem : "ファイル書き込み"
UC014 --> FileSystem : "履歴ファイル保存"

' インクルード関係
UC001 ..> UC002 : "<<include>>"
UC005 ..> UC004 : "<<include>>"
UC009 ..> UC004 : "<<include>>"
UC010 ..> UC004 : "<<include>>"
UC010 ..> UC011 : "<<include>>"
UC010 ..> UC012 : "<<include>>"
UC012 ..> UC021 : "<<include>>"

' エクステンド関係
UC010 ..> UC013 : "<<extend>>\n[エラー発生時]"
UC001 ..> UC003 : "<<extend>>\n[トークン期限切れ]"
UC010 ..> UC014 : "<<extend>>\n[完了時]"
UC013 ..> UC022 : "<<extend>>\n[復旧不可時]"

@enduml