# コードレビュールール（汎用）

**適用範囲**: すべてのソフトウェア開発プロジェクト  
**依存性レベル**: Level 1 (Universal) - プロジェクト・技術非依存  
**参照ポリシー**: [git_workflow_policy.md](../../policies/universal/git_workflow_policy.md), [project_quality_management_policy.md](../../policies/universal/project_quality_management_policy.md)

## 1. 基本レビュールール

### 1.1 必須レビュー事項
```markdown
機能・ロジック:
☐ 要件・仕様通りの実装確認
☐ エッジケース・例外処理の適切性
☐ アルゴリズム・データ構造の効率性
☐ ビジネスロジックの正確性・完全性

コード品質:
☐ 可読性・保守性・拡張性の評価
☐ 命名規則・コーディング規約の遵守
☐ 重複コード・リファクタリング機会の特定
☐ 設計原則（SOLID等）の適用確認

セキュリティ:
☐ 入力検証・サニタイゼーション確認
☐ 認証・認可・アクセス制御の適切性
☐ 秘密情報・機密データの適切な処理
☐ 既知の脆弱性パターン・OWASP対応

テスト:
☐ テストケース・カバレッジの十分性
☐ 単体・統合・E2Eテストの適切性
☐ テストの可読性・保守性
☐ モック・スタブの適切な使用
```

### 1.2 レビュー品質基準
```markdown
承認基準:
- 機能要件100%満足
- セキュリティ脆弱性0件
- 重大なコード品質問題0件
- 必要なテスト実装完了
- ドキュメント更新完了

拒否基準:
- 動作しない・ビルドエラー
- セキュリティ脆弱性存在
- 重大なパフォーマンス問題
- テスト未実装・失敗
- コーディング規約重大違反
```

## 2. レビュープロセス

### 2.1 レビュー段階
```markdown
1. 自己レビュー（Self Review）:
   ✓ プルリクエスト提出前の自主確認
   ✓ チェックリストによる網羅的確認
   ✓ 自動ツール（Linter・静的解析）実行
   ✓ テスト実行・結果確認

2. ピアレビュー（Peer Review）:
   ✓ 同僚開発者による相互レビュー
   ✓ 2名以上のレビュアー参加
   ✓ 建設的フィードバック・改善提案
   ✓ 知識共有・学習機会として活用

3. 専門レビュー（Specialist Review）:
   ✓ セキュリティ専門家レビュー（必要時）
   ✓ アーキテクト・シニア開発者レビュー
   ✓ パフォーマンス・インフラ専門家レビュー
   ✓ ドメインエキスパートレビュー

4. 最終承認（Final Approval）:
   ✓ チームリーダー・技術責任者承認
   ✓ 全フィードバック対応完了確認
   ✓ CI/CD・自動テスト合格確認
   ✓ マージ・デプロイ承認
```

### 2.2 レビュー時間・効率
```markdown
レビュー時間目標:
- 小規模変更（<100行）: 24時間以内
- 中規模変更（100-500行）: 48時間以内  
- 大規模変更（>500行）: 72時間以内
- 緊急修正: 4時間以内

効率化施策:
- 小さく・頻繁なプルリクエスト推奨
- レビューポイント・懸念事項の明確化
- 自動ツール活用による効率化
- レビュー負荷の適切な分散
```

## 3. レビューコメント・フィードバック

### 3.1 コメント分類
```markdown
必須対応（Must Fix）:
🔴 セキュリティ脆弱性・重大バグ
🔴 機能要件・仕様違反
🔴 重大なパフォーマンス問題
🔴 コーディング規約重要違反

推奨対応（Should Fix）:
🟡 コード品質・可読性改善
🟡 パフォーマンス最適化機会
🟡 保守性・拡張性向上
🟡 ベストプラクティス適用

提案事項（Consider）:
🟢 代替実装・改善アイデア
🟢 将来の拡張・改良提案
🟢 学習・知識共有事項
🟢 リファクタリング機会
```

### 3.2 建設的フィードバック原則
```markdown
ポジティブアプローチ:
- 問題指摘だけでなく改善案提示
- 良いコード・工夫の積極的評価
- 学習機会・成長支援の視点
- チーム全体の品質向上意識

具体性・明確性:
- 具体的な問題箇所・理由の明示
- 改善方法・代替案の提示
- 参考資料・ドキュメントの紹介
- 重要度・優先度の明確化

相互尊重:
- 建設的・専門的な議論の維持
- 個人攻撃・感情的な表現回避
- 多様な視点・意見の尊重
- オープンマインド・学習意欲
```

## 4. レビューチェックリスト

### 4.1 機能・ロジックチェック
```markdown
☐ 要求仕様・設計書との整合性確認
☐ ビジネスロジック・計算処理の正確性
☐ エラーハンドリング・例外処理の適切性
☐ 境界値・エッジケースの適切な処理
☐ 並行処理・競合状態の考慮
☐ パフォーマンス・効率性の評価
☐ メモリ使用・リソース管理の適切性
☐ 外部依存・APIの適切な使用
```

### 4.2 コード品質チェック
```markdown
☐ 命名規則・一貫性の確認
☐ 関数・クラス・モジュールの適切なサイズ
☐ 単一責任原則・関心の分離
☐ 重複コード・コピーペーストの排除
☐ マジックナンバー・ハードコーディング排除
☐ コメント・ドキュメントの適切性
☐ 型安全性・型ヒントの活用
☐ デザインパターンの適切な適用
```

### 4.3 セキュリティチェック
```markdown
☐ 入力検証・サニタイゼーション実装
☐ SQLインジェクション対策
☐ XSS（Cross-Site Scripting）対策
☐ CSRF（Cross-Site Request Forgery）対策
☐ 認証・認可・セッション管理
☐ 秘密情報・機密データの保護
☐ ログ・監査情報の適切な記録
☐ 暗号化・ハッシュ化の適切な使用
```

### 4.4 テスト・品質保証チェック
```markdown
☐ 単体テストの実装・カバレッジ
☐ 統合テスト・E2Eテストの必要性
☐ テストケースの網羅性・妥当性
☐ テストの可読性・保守性
☐ モック・スタブの適切な使用
☐ テストデータ・環境の管理
☐ CI/CD・自動テストの統合
☐ パフォーマンステストの考慮
```

## 5. ツール・自動化

### 5.1 自動チェックツール
```markdown
静的解析ツール:
- 構文エラー・型エラーの自動検出
- コーディング規約・スタイル違反検出
- 潜在的バグ・脆弱性の早期発見
- 複雑度・品質メトリクスの測定

リンター・フォーマッター:
- コードスタイル・フォーマットの統一
- 命名規則・慣習の自動チェック
- 不要コード・未使用変数の検出
- インポート・依存関係の整理

セキュリティスキャナー:
- 既知の脆弱性・セキュリティホール検出
- 依存ライブラリの脆弱性確認
- 秘密情報・認証情報の誤コミット検出
- セキュリティベストプラクティス確認
```

### 5.2 レビュー支援ツール
```markdown
差分・比較ツール:
- サイドバイサイド・統合差分表示
- ファイル・ディレクトリレベルの変更概要
- 変更履歴・コミット情報の表示
- コンフリクト・マージ支援機能

コメント・議論機能:
- インライン・ファイル単位コメント
- スレッド・ディスカッション機能
- レビューステータス・進捗管理
- 通知・リマインダー機能

メトリクス・分析:
- レビュー時間・品質の測定
- バグ検出率・修正コストの分析
- レビュアー・チームパフォーマンス分析
- 継続改善・ベンチマーク機能
```

## 6. 特殊ケース・例外処理

### 6.1 緊急修正・ホットフィックス
```markdown
緊急時プロセス:
- 重大障害・セキュリティインシデント対応
- 簡略化レビュープロセス・最小限チェック
- 事後詳細レビュー・品質改善の実施
- 再発防止・プロセス改善の検討

最小要件:
- 機能・セキュリティの基本確認
- 1名以上のシニア開発者承認
- 自動テスト・CI/CD実行確認
- デプロイ後の動作確認・監視
```

### 6.2 大規模リファクタリング
```markdown
特別対応:
- 段階的・計画的なレビューアプローチ
- アーキテクト・専門家の早期関与
- 影響範囲・リスク分析の詳細実施
- 十分なテスト・検証・ロールバック計画

レビュー戦略:
- 設計・アプローチの事前レビュー
- 段階的実装・部分的レビュー
- 統合・全体整合性の最終確認
- 長期メンテナンス・進化の考慮
```

## 7. 品質メトリクス・改善

### 7.1 測定指標
```markdown
効率性指標:
- 平均レビュー時間・処理時間
- レビュー待ち時間・ボトルネック分析
- プルリクエストサイズ・頻度
- 自動化率・手動作業比率

品質指標:
- バグ検出率・修正コスト削減
- リリース後バグ・障害発生率
- コードカバレッジ・テスト品質
- 顧客満足度・システム安定性

学習・成長指標:
- レビューフィードバック・知識共有
- スキル向上・ベストプラクティス普及
- チーム協力・コミュニケーション質
- イノベーション・創造性の促進
```

### 7.2 継続改善
```markdown
改善サイクル:
- 定期的なレビュープロセス評価
- メトリクス・フィードバック分析
- ボトルネック・問題点の特定
- 改善施策・実験の実施・評価

ベストプラクティス:
- 成功事例・優秀なレビューの共有
- 失敗・問題事例の教訓化
- 業界動向・新技術の調査・導入
- チーム文化・意識の継続的向上
```

---

**策定日**: 2025-08-09  
**適用範囲**: 全プロジェクト・全コード変更  
**見直し頻度**: 四半期毎またはプロセス改善時