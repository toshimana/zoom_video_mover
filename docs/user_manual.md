# GUI 操作マニュアル

Zoom Video Mover GUI アプリケーションの操作手順を説明します。

**前提**: セットアップが完了していること（[README.md](../README.md) 参照）

**起動コマンド**:

```powershell
cargo run --release
```

---

## 画面構成

アプリケーションは以下の4つのタブで構成されています。

| タブ | 表示条件 |
|------|----------|
| 設定 | 常に表示 |
| 認証 | 設定が有効な場合に表示 |
| 録画リスト | 認証が完了した場合に表示 |
| ダウンロード | ダウンロード実行中に表示 |

画面下部にはステータスバーがあり、現在の状態がリアルタイムで表示されます。

---

## Step 1: 設定

アプリ起動後、最初に表示される画面です。

### 入力項目

| フィールド | 説明 |
|-----------|------|
| Client ID | Zoom Developer App の Client ID |
| Client Secret | Zoom Developer App の Client Secret（パスワード形式で非表示） |
| Output Directory | ダウンロード先ディレクトリ（デフォルト: ユーザーのダウンロードフォルダ） |

### ボタン

- **「設定を保存」**（緑）: 入力内容を `config.toml` に保存
- **「設定を読込」**（青）: `config.toml` から設定を読み込み

### バリデーション

- 赤「⚠ Client ID is required」 — Client ID が未入力
- 赤「⚠ Client Secret is required」 — Client Secret が未入力
- 緑「✓ 設定が有効です」 — すべての項目が入力済み → 認証タブが有効化

---

## Step 2: 認証

Zoom API へのアクセス許可を取得します。

### 手順

1. **「認証開始」** ボタンをクリック → 認証 URL が生成される
2. 認証 URL を使用する:
   - **「📋 コピー」** ボタン: URL をクリップボードにコピー
   - **「ブラウザで開く」** ボタン: デフォルトブラウザで URL を開く
3. ブラウザで Zoom にログインし、アプリへのアクセスを承認する
4. 承認後に表示される認証コードをコピーする
5. **「Authorization Code」** フィールドに認証コードを貼り付ける
6. **「認証完了」** ボタンをクリック（認証コード未入力時は無効）

### 認証状態の表示

| 状態 | 表示 |
|------|------|
| 未認証 | Status: Ready |
| URL 生成済み | Status: Auth URL Generated |
| コード入力待ち | Status: Waiting for Code |
| 認証完了 | Status: Authenticated / 緑「✓ Authenticated」 |

### 再認証

認証完了後に **「Reset Authentication」** ボタンをクリックすると、認証状態がリセットされ、再認証が可能になります。

---

## Step 3: 録画の検索と選択

認証完了後、録画リストタブで Zoom クラウド録画を検索・選択します。

### 検索

1. **From**: 検索開始日（デフォルト: 当月1日、形式: `YYYY-MM-DD`）
2. **To**: 検索終了日（デフォルト: 今日、形式: `YYYY-MM-DD`）
3. **「検索実行」** ボタンをクリック → Zoom API から録画一覧を取得

### 録画の選択

検索結果はミーティング単位で表示され、各ミーティング配下にファイルが一覧されます。

- **ミーティング単位**: チェックボックスでミーティング全体を選択
- **ファイル単位**: 個別ファイルのチェックボックスで特定ファイルのみ選択

### ファイルタイプ

| タイプ | 拡張子 | 内容 |
|--------|--------|------|
| MP4 | .mp4 | 動画 |
| M4A | .m4a | 音声 |
| TRANSCRIPT | .vtt | トランスクリプト |
| CHAT | .txt | チャットログ |
| CC | .vtt | クローズドキャプション |
| TIMELINE | .json | タイムライン |

### ダウンロード開始

画面下部に選択件数（`Selected: N items`）が表示されます。
1件以上選択すると **「ダウンロード」** ボタンが有効になります。クリックするとダウンロードが開始されます。

---

## Step 4: ダウンロード

ダウンロード中の進捗を確認・制御します。

### 進捗表示

- **Overall Progress**: 全体の進捗バー（パーセンテージ表示）
- **Current**: 現在ダウンロード中のファイル名
- **Progress**: ファイル単位の進捗バー

### 制御ボタン

| ボタン | 色 | 動作 |
|--------|-----|------|
| 一時停止 | オレンジ | ダウンロードを一時停止（一時停止中は「再開」ボタンに切替） |
| 再開 | 緑 | 一時停止中のダウンロードを再開 |
| キャンセル | 赤 | ダウンロードを中止 |

### Download Log

画面下部のスクロール可能なエリアにダウンロードログがリアルタイムで表示されます。

### 完了後

ダウンロード完了後は録画リスト画面に戻り、続けて別の録画をダウンロードできます。

---

## エラーが発生した場合

エラー発生時は自動的にエラー画面に遷移し、エラー種別が自動判定されます。

### エラー種別と推奨アクション

| エラー種別 | 推奨アクション |
|-----------|---------------|
| 認証エラー | Client ID / Client Secret を確認、Zoom Developer App の設定を確認 |
| ネットワークエラー | インターネット接続を確認、ファイアウォール設定を確認 |
| ファイルエラー | ディスク容量を確認、出力ディレクトリの権限を確認 |
| 一般エラー | 設定を確認してからリトライ |

### アクションボタン

- **「リトライ」**: 録画リスト画面に戻り、操作をやり直す
- **「設定に戻る」**: 設定画面に戻り、設定内容を見直す
- **「ログ出力」**（青）: エラーログをファイルに出力

ログファイルの出力先: `{Output Directory}/zoom_video_mover_log_YYYYMMDD_HHMMSS.txt`

詳細なトラブルシューティングは [README.md](../README.md) を参照してください。

---

## 補足: config.toml の高度な設定

GUI から設定できない項目は `config.toml` を直接編集して変更できます。

| 項目 | デフォルト値 | 説明 |
|------|-------------|------|
| `max_concurrent_downloads` | 3 | 並列ダウンロード数（1〜10） |
| `request_timeout_seconds` | 30 | リクエストタイムアウト秒数（5〜300） |
| `rate_limit_per_second` | 10 | API レート制限（リクエスト/秒） |
| `debug_mode` | false | デバッグモード |
| `log_level` | "info" | ログレベル |

セットアップ・トラブルシューティングについては [README.md](../README.md) を参照してください。
